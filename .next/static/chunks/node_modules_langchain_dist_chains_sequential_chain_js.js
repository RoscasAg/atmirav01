"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_langchain_dist_chains_sequential_chain_js"],{

/***/ "./node_modules/langchain/dist/chains/sequential_chain.js":
/*!****************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/sequential_chain.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SequentialChain: function() { return /* binding */ SequentialChain; },\n/* harmony export */   SimpleSequentialChain: function() { return /* binding */ SimpleSequentialChain; }\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.js */ \"./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _util_set_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/set.js */ \"./node_modules/langchain/dist/util/set.js\");\n\n\nfunction formatSet(input) {\n    return Array.from(input)\n        .map((i) => `\"${i}\"`)\n        .join(\", \");\n}\n/**\n * Chain where the outputs of one chain feed directly into next.\n * @example\n * ```typescript\n * const promptTemplate = new PromptTemplate({\n *   template: `You are a playwright. Given the title of play and the era it is set in, it is your job to write a synopsis for that title.\n * Title: {title}\n * Era: {era}\n * Playwright: This is a synopsis for the above play:`,\n *   inputVariables: [\"title\", \"era\"],\n * });\n\n * const reviewPromptTemplate = new PromptTemplate({\n *   template: `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n *     Play Synopsis:\n *     {synopsis}\n *     Review from a New York Times play critic of the above play:`,\n *   inputVariables: [\"synopsis\"],\n * });\n\n * const overallChain = new SequentialChain({\n *   chains: [\n *     new LLMChain({\n *       llm: new ChatOpenAI({ temperature: 0 }),\n *       prompt: promptTemplate,\n *       outputKey: \"synopsis\",\n *     }),\n *     new LLMChain({\n *       llm: new OpenAI({ temperature: 0 }),\n *       prompt: reviewPromptTemplate,\n *       outputKey: \"review\",\n *     }),\n *   ],\n *   inputVariables: [\"era\", \"title\"],\n *   outputVariables: [\"synopsis\", \"review\"],\n *   verbose: true,\n * });\n\n * const chainExecutionResult = await overallChain.call({\n *   title: \"Tragedy at sunset on the beach\",\n *   era: \"Victorian England\",\n * });\n * console.log(chainExecutionResult);\n * ```\n *\n * @deprecated\n * Switch to {@link https://js.langchain.com/docs/expression_language/ | expression language}.\n * Will be removed in 0.2.0\n */\nclass SequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SequentialChain\";\n    }\n    get inputKeys() {\n        return this.inputVariables;\n    }\n    get outputKeys() {\n        return this.outputVariables;\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"outputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"returnAll\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.inputVariables = fields.inputVariables;\n        this.outputVariables = fields.outputVariables ?? [];\n        if (this.outputVariables.length > 0 && fields.returnAll) {\n            throw new Error(\"Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.\");\n        }\n        this.returnAll = fields.returnAll ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        if (this.chains.length === 0) {\n            throw new Error(\"Sequential chain must have at least one chain.\");\n        }\n        const memoryKeys = this.memory?.memoryKeys ?? [];\n        const inputKeysSet = new Set(this.inputKeys);\n        const memoryKeysSet = new Set(memoryKeys);\n        const keysIntersection = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(inputKeysSet, memoryKeysSet);\n        if (keysIntersection.size > 0) {\n            throw new Error(`The following keys: ${formatSet(keysIntersection)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);\n        }\n        const availableKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.union)(inputKeysSet, memoryKeysSet);\n        for (const chain of this.chains) {\n            let missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(chain.inputKeys), availableKeys);\n            if (chain.memory) {\n                missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(missingKeys, new Set(chain.memory.memoryKeys));\n            }\n            if (missingKeys.size > 0) {\n                throw new Error(`Missing variables for chain \"${chain._chainType()}\": ${formatSet(missingKeys)}. Only got the following variables: ${formatSet(availableKeys)}.`);\n            }\n            const outputKeysSet = new Set(chain.outputKeys);\n            const overlappingOutputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(availableKeys, outputKeysSet);\n            if (overlappingOutputKeys.size > 0) {\n                throw new Error(`The following output variables for chain \"${chain._chainType()}\" are overlapping: ${formatSet(overlappingOutputKeys)}. This can lead to unexpected behaviour.`);\n            }\n            for (const outputKey of outputKeysSet) {\n                availableKeys.add(outputKey);\n            }\n        }\n        if (this.outputVariables.length === 0) {\n            if (this.returnAll) {\n                const outputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(availableKeys, inputKeysSet);\n                this.outputVariables = Array.from(outputKeys);\n            }\n            else {\n                this.outputVariables = this.chains[this.chains.length - 1].outputKeys;\n            }\n        }\n        else {\n            const missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(this.outputVariables), new Set(availableKeys));\n            if (missingKeys.size > 0) {\n                throw new Error(`The following output variables were expected to be in the final chain output but were not found: ${formatSet(missingKeys)}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = {};\n        const allChainValues = values;\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = await chain.call(allChainValues, runManager?.getChild(`step_${i}`));\n            for (const key of Object.keys(input)) {\n                allChainValues[key] = input[key];\n            }\n        }\n        const output = {};\n        for (const key of this.outputVariables) {\n            output[key] = allChainValues[key];\n        }\n        return output;\n    }\n    _chainType() {\n        return \"sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const inputVariables = data.input_variables;\n        const outputVariables = data.output_variables;\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SequentialChain({ chains, inputVariables, outputVariables });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            input_variables: this.inputVariables,\n            output_variables: this.outputVariables,\n            chains,\n        };\n    }\n}\n/**\n * @deprecated Switch to expression language: https://js.langchain.com/docs/expression_language/\n * Simple chain where a single string output of one chain is fed directly into the next.\n * @augments BaseChain\n * @augments SimpleSequentialChainInput\n *\n * @example\n * ```ts\n * import { SimpleSequentialChain, LLMChain } from \"langchain/chains\";\n * import { OpenAI } from \"langchain/llms/openai\";\n * import { PromptTemplate } from \"langchain/prompts\";\n *\n * // This is an LLMChain to write a synopsis given a title of a play.\n * const llm = new OpenAI({ temperature: 0 });\n * const template = `You are a playwright. Given the title of play, it is your job to write a synopsis for that title.\n *\n * Title: {title}\n * Playwright: This is a synopsis for the above play:`\n * const promptTemplate = new PromptTemplate({ template, inputVariables: [\"title\"] });\n * const synopsisChain = new LLMChain({ llm, prompt: promptTemplate });\n *\n *\n * // This is an LLMChain to write a review of a play given a synopsis.\n * const reviewLLM = new OpenAI({ temperature: 0 })\n * const reviewTemplate = `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n * Play Synopsis:\n * {synopsis}\n * Review from a New York Times play critic of the above play:`\n * const reviewPromptTemplate = new PromptTemplate({ template: reviewTemplate, inputVariables: [\"synopsis\"] });\n * const reviewChain = new LLMChain({ llm: reviewLLM, prompt: reviewPromptTemplate });\n *\n * const overallChain = new SimpleSequentialChain({chains: [synopsisChain, reviewChain], verbose:true})\n * const review = await overallChain.run(\"Tragedy at sunset on the beach\")\n * // the variable review contains resulting play review.\n * ```\n */\nclass SimpleSequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SimpleSequentialChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey];\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input\"\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"output\"\n        });\n        Object.defineProperty(this, \"trimOutputs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.trimOutputs = fields.trimOutputs ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        for (const chain of this.chains) {\n            if (chain.inputKeys.filter((k) => !chain.memory?.memoryKeys.includes(k) ?? true).length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one input, got ${chain.inputKeys.length} for ${chain._chainType()}.`);\n            }\n            if (chain.outputKeys.length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one output, got ${chain.outputKeys.length} for ${chain._chainType()}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = values[this.inputKey];\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = (await chain.call({ [chain.inputKeys[0]]: input, signal: values.signal }, runManager?.getChild(`step_${i}`)))[chain.outputKeys[0]];\n            if (this.trimOutputs) {\n                input = input.trim();\n            }\n            await runManager?.handleText(input);\n        }\n        return { [this.outputKey]: input };\n    }\n    _chainType() {\n        return \"simple_sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SimpleSequentialChain({ chains });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            chains,\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhaW5zL3NlcXVlbnRpYWxfY2hhaW4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzQztBQUMyQjtBQUNqRTtBQUNBO0FBQ0Esd0JBQXdCLEVBQUU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGdCQUFnQjtBQUMvQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLCtFQUErRTtBQUM3RjtBQUNBO0FBQ08sOEJBQThCLCtDQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsMERBQVk7QUFDN0M7QUFDQSxtREFBbUQsNkJBQTZCO0FBQ2hGO0FBQ0EsOEJBQThCLG1EQUFLO0FBQ25DO0FBQ0EsOEJBQThCLHdEQUFVO0FBQ3hDO0FBQ0EsOEJBQThCLHdEQUFVO0FBQ3hDO0FBQ0E7QUFDQSxnRUFBZ0UsbUJBQW1CLEtBQUssdUJBQXVCLHNDQUFzQyx5QkFBeUI7QUFDOUs7QUFDQTtBQUNBLDBDQUEwQywwREFBWTtBQUN0RDtBQUNBLDZFQUE2RSxtQkFBbUIscUJBQXFCLGlDQUFpQztBQUN0SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyx3REFBVTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyx3REFBVTtBQUMxQztBQUNBLG9JQUFvSSx1QkFBdUI7QUFDM0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsRUFBRTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywrQ0FBUztBQUNyRDtBQUNBO0FBQ0EscUNBQXFDLHlDQUF5QztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0NBQWtDO0FBQzlDLFlBQVksU0FBUztBQUNyQixZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0EsNEJBQTRCLGdCQUFnQjtBQUM1QztBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsK0NBQStDLHFDQUFxQztBQUNwRix3Q0FBd0MsNkJBQTZCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxnQkFBZ0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EscURBQXFELHdEQUF3RDtBQUM3RyxzQ0FBc0MsOENBQThDO0FBQ3BGO0FBQ0EsbURBQW1ELG1EQUFtRDtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNPLG9DQUFvQywrQ0FBUztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUdBQXVHLHdCQUF3QixNQUFNLG1CQUFtQjtBQUN4SjtBQUNBO0FBQ0Esd0dBQXdHLHlCQUF5QixNQUFNLG1CQUFtQjtBQUMxSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msb0RBQW9ELCtCQUErQixFQUFFO0FBQzdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QywrQ0FBUztBQUNyRDtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9jaGFpbnMvc2VxdWVudGlhbF9jaGFpbi5qcz9jNmNjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VDaGFpbiB9IGZyb20gXCIuL2Jhc2UuanNcIjtcbmltcG9ydCB7IGludGVyc2VjdGlvbiwgdW5pb24sIGRpZmZlcmVuY2UgfSBmcm9tIFwiLi4vdXRpbC9zZXQuanNcIjtcbmZ1bmN0aW9uIGZvcm1hdFNldChpbnB1dCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGlucHV0KVxuICAgICAgICAubWFwKChpKSA9PiBgXCIke2l9XCJgKVxuICAgICAgICAuam9pbihcIiwgXCIpO1xufVxuLyoqXG4gKiBDaGFpbiB3aGVyZSB0aGUgb3V0cHV0cyBvZiBvbmUgY2hhaW4gZmVlZCBkaXJlY3RseSBpbnRvIG5leHQuXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgcHJvbXB0VGVtcGxhdGUgPSBuZXcgUHJvbXB0VGVtcGxhdGUoe1xuICogICB0ZW1wbGF0ZTogYFlvdSBhcmUgYSBwbGF5d3JpZ2h0LiBHaXZlbiB0aGUgdGl0bGUgb2YgcGxheSBhbmQgdGhlIGVyYSBpdCBpcyBzZXQgaW4sIGl0IGlzIHlvdXIgam9iIHRvIHdyaXRlIGEgc3lub3BzaXMgZm9yIHRoYXQgdGl0bGUuXG4gKiBUaXRsZToge3RpdGxlfVxuICogRXJhOiB7ZXJhfVxuICogUGxheXdyaWdodDogVGhpcyBpcyBhIHN5bm9wc2lzIGZvciB0aGUgYWJvdmUgcGxheTpgLFxuICogICBpbnB1dFZhcmlhYmxlczogW1widGl0bGVcIiwgXCJlcmFcIl0sXG4gKiB9KTtcblxuICogY29uc3QgcmV2aWV3UHJvbXB0VGVtcGxhdGUgPSBuZXcgUHJvbXB0VGVtcGxhdGUoe1xuICogICB0ZW1wbGF0ZTogYFlvdSBhcmUgYSBwbGF5IGNyaXRpYyBmcm9tIHRoZSBOZXcgWW9yayBUaW1lcy4gR2l2ZW4gdGhlIHN5bm9wc2lzIG9mIHBsYXksIGl0IGlzIHlvdXIgam9iIHRvIHdyaXRlIGEgcmV2aWV3IGZvciB0aGF0IHBsYXkuXG4gKlxuICogICAgIFBsYXkgU3lub3BzaXM6XG4gKiAgICAge3N5bm9wc2lzfVxuICogICAgIFJldmlldyBmcm9tIGEgTmV3IFlvcmsgVGltZXMgcGxheSBjcml0aWMgb2YgdGhlIGFib3ZlIHBsYXk6YCxcbiAqICAgaW5wdXRWYXJpYWJsZXM6IFtcInN5bm9wc2lzXCJdLFxuICogfSk7XG5cbiAqIGNvbnN0IG92ZXJhbGxDaGFpbiA9IG5ldyBTZXF1ZW50aWFsQ2hhaW4oe1xuICogICBjaGFpbnM6IFtcbiAqICAgICBuZXcgTExNQ2hhaW4oe1xuICogICAgICAgbGxtOiBuZXcgQ2hhdE9wZW5BSSh7IHRlbXBlcmF0dXJlOiAwIH0pLFxuICogICAgICAgcHJvbXB0OiBwcm9tcHRUZW1wbGF0ZSxcbiAqICAgICAgIG91dHB1dEtleTogXCJzeW5vcHNpc1wiLFxuICogICAgIH0pLFxuICogICAgIG5ldyBMTE1DaGFpbih7XG4gKiAgICAgICBsbG06IG5ldyBPcGVuQUkoeyB0ZW1wZXJhdHVyZTogMCB9KSxcbiAqICAgICAgIHByb21wdDogcmV2aWV3UHJvbXB0VGVtcGxhdGUsXG4gKiAgICAgICBvdXRwdXRLZXk6IFwicmV2aWV3XCIsXG4gKiAgICAgfSksXG4gKiAgIF0sXG4gKiAgIGlucHV0VmFyaWFibGVzOiBbXCJlcmFcIiwgXCJ0aXRsZVwiXSxcbiAqICAgb3V0cHV0VmFyaWFibGVzOiBbXCJzeW5vcHNpc1wiLCBcInJldmlld1wiXSxcbiAqICAgdmVyYm9zZTogdHJ1ZSxcbiAqIH0pO1xuXG4gKiBjb25zdCBjaGFpbkV4ZWN1dGlvblJlc3VsdCA9IGF3YWl0IG92ZXJhbGxDaGFpbi5jYWxsKHtcbiAqICAgdGl0bGU6IFwiVHJhZ2VkeSBhdCBzdW5zZXQgb24gdGhlIGJlYWNoXCIsXG4gKiAgIGVyYTogXCJWaWN0b3JpYW4gRW5nbGFuZFwiLFxuICogfSk7XG4gKiBjb25zb2xlLmxvZyhjaGFpbkV4ZWN1dGlvblJlc3VsdCk7XG4gKiBgYGBcbiAqXG4gKiBAZGVwcmVjYXRlZFxuICogU3dpdGNoIHRvIHtAbGluayBodHRwczovL2pzLmxhbmdjaGFpbi5jb20vZG9jcy9leHByZXNzaW9uX2xhbmd1YWdlLyB8IGV4cHJlc3Npb24gbGFuZ3VhZ2V9LlxuICogV2lsbCBiZSByZW1vdmVkIGluIDAuMi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTZXF1ZW50aWFsQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJTZXF1ZW50aWFsQ2hhaW5cIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRWYXJpYWJsZXM7XG4gICAgfVxuICAgIGdldCBvdXRwdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXRWYXJpYWJsZXM7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGZpZWxkcykge1xuICAgICAgICBzdXBlcihmaWVsZHMpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjaGFpbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaW5wdXRWYXJpYWJsZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3V0cHV0VmFyaWFibGVzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJldHVybkFsbFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNoYWlucyA9IGZpZWxkcy5jaGFpbnM7XG4gICAgICAgIHRoaXMuaW5wdXRWYXJpYWJsZXMgPSBmaWVsZHMuaW5wdXRWYXJpYWJsZXM7XG4gICAgICAgIHRoaXMub3V0cHV0VmFyaWFibGVzID0gZmllbGRzLm91dHB1dFZhcmlhYmxlcyA/PyBbXTtcbiAgICAgICAgaWYgKHRoaXMub3V0cHV0VmFyaWFibGVzLmxlbmd0aCA+IDAgJiYgZmllbGRzLnJldHVybkFsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRWl0aGVyIHNwZWNpZnkgdmFyaWFibGVzIHRvIHJldHVybiB1c2luZyBgb3V0cHV0VmFyaWFibGVzYCBvciB1c2UgYHJldHVybkFsbGAgcGFyYW0uIENhbm5vdCBhcHBseSBib3RoIGNvbmRpdGlvbnMgYXQgdGhlIHNhbWUgdGltZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXR1cm5BbGwgPSBmaWVsZHMucmV0dXJuQWxsID8/IGZhbHNlO1xuICAgICAgICB0aGlzLl92YWxpZGF0ZUNoYWlucygpO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIF92YWxpZGF0ZUNoYWlucygpIHtcbiAgICAgICAgaWYgKHRoaXMuY2hhaW5zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2VxdWVudGlhbCBjaGFpbiBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIGNoYWluLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtZW1vcnlLZXlzID0gdGhpcy5tZW1vcnk/Lm1lbW9yeUtleXMgPz8gW107XG4gICAgICAgIGNvbnN0IGlucHV0S2V5c1NldCA9IG5ldyBTZXQodGhpcy5pbnB1dEtleXMpO1xuICAgICAgICBjb25zdCBtZW1vcnlLZXlzU2V0ID0gbmV3IFNldChtZW1vcnlLZXlzKTtcbiAgICAgICAgY29uc3Qga2V5c0ludGVyc2VjdGlvbiA9IGludGVyc2VjdGlvbihpbnB1dEtleXNTZXQsIG1lbW9yeUtleXNTZXQpO1xuICAgICAgICBpZiAoa2V5c0ludGVyc2VjdGlvbi5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZm9sbG93aW5nIGtleXM6ICR7Zm9ybWF0U2V0KGtleXNJbnRlcnNlY3Rpb24pfSBhcmUgb3ZlcmxhcHBpbmcgYmV0d2VlbiBtZW1vcnkgYW5kIGlucHV0IGtleXMgb2YgdGhlIGNoYWluIHZhcmlhYmxlcy4gVGhpcyBjYW4gbGVhZCB0byB1bmV4cGVjdGVkIGJlaGF2aW91ci4gUGxlYXNlIHVzZSBpbnB1dCBhbmQgbWVtb3J5IGtleXMgdGhhdCBkb24ndCBvdmVybGFwLmApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZUtleXMgPSB1bmlvbihpbnB1dEtleXNTZXQsIG1lbW9yeUtleXNTZXQpO1xuICAgICAgICBmb3IgKGNvbnN0IGNoYWluIG9mIHRoaXMuY2hhaW5zKSB7XG4gICAgICAgICAgICBsZXQgbWlzc2luZ0tleXMgPSBkaWZmZXJlbmNlKG5ldyBTZXQoY2hhaW4uaW5wdXRLZXlzKSwgYXZhaWxhYmxlS2V5cyk7XG4gICAgICAgICAgICBpZiAoY2hhaW4ubWVtb3J5KSB7XG4gICAgICAgICAgICAgICAgbWlzc2luZ0tleXMgPSBkaWZmZXJlbmNlKG1pc3NpbmdLZXlzLCBuZXcgU2V0KGNoYWluLm1lbW9yeS5tZW1vcnlLZXlzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWlzc2luZ0tleXMuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgdmFyaWFibGVzIGZvciBjaGFpbiBcIiR7Y2hhaW4uX2NoYWluVHlwZSgpfVwiOiAke2Zvcm1hdFNldChtaXNzaW5nS2V5cyl9LiBPbmx5IGdvdCB0aGUgZm9sbG93aW5nIHZhcmlhYmxlczogJHtmb3JtYXRTZXQoYXZhaWxhYmxlS2V5cyl9LmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgb3V0cHV0S2V5c1NldCA9IG5ldyBTZXQoY2hhaW4ub3V0cHV0S2V5cyk7XG4gICAgICAgICAgICBjb25zdCBvdmVybGFwcGluZ091dHB1dEtleXMgPSBpbnRlcnNlY3Rpb24oYXZhaWxhYmxlS2V5cywgb3V0cHV0S2V5c1NldCk7XG4gICAgICAgICAgICBpZiAob3ZlcmxhcHBpbmdPdXRwdXRLZXlzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZm9sbG93aW5nIG91dHB1dCB2YXJpYWJsZXMgZm9yIGNoYWluIFwiJHtjaGFpbi5fY2hhaW5UeXBlKCl9XCIgYXJlIG92ZXJsYXBwaW5nOiAke2Zvcm1hdFNldChvdmVybGFwcGluZ091dHB1dEtleXMpfS4gVGhpcyBjYW4gbGVhZCB0byB1bmV4cGVjdGVkIGJlaGF2aW91ci5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3Qgb3V0cHV0S2V5IG9mIG91dHB1dEtleXNTZXQpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVLZXlzLmFkZChvdXRwdXRLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm91dHB1dFZhcmlhYmxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJldHVybkFsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dEtleXMgPSBkaWZmZXJlbmNlKGF2YWlsYWJsZUtleXMsIGlucHV0S2V5c1NldCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRWYXJpYWJsZXMgPSBBcnJheS5mcm9tKG91dHB1dEtleXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRWYXJpYWJsZXMgPSB0aGlzLmNoYWluc1t0aGlzLmNoYWlucy5sZW5ndGggLSAxXS5vdXRwdXRLZXlzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbWlzc2luZ0tleXMgPSBkaWZmZXJlbmNlKG5ldyBTZXQodGhpcy5vdXRwdXRWYXJpYWJsZXMpLCBuZXcgU2V0KGF2YWlsYWJsZUtleXMpKTtcbiAgICAgICAgICAgIGlmIChtaXNzaW5nS2V5cy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGZvbGxvd2luZyBvdXRwdXQgdmFyaWFibGVzIHdlcmUgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIGZpbmFsIGNoYWluIG91dHB1dCBidXQgd2VyZSBub3QgZm91bmQ6ICR7Zm9ybWF0U2V0KG1pc3NpbmdLZXlzKX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICBhc3luYyBfY2FsbCh2YWx1ZXMsIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgbGV0IGlucHV0ID0ge307XG4gICAgICAgIGNvbnN0IGFsbENoYWluVmFsdWVzID0gdmFsdWVzO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGkgKz0gMTtcbiAgICAgICAgICAgIGlucHV0ID0gYXdhaXQgY2hhaW4uY2FsbChhbGxDaGFpblZhbHVlcywgcnVuTWFuYWdlcj8uZ2V0Q2hpbGQoYHN0ZXBfJHtpfWApKTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIGFsbENoYWluVmFsdWVzW2tleV0gPSBpbnB1dFtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLm91dHB1dFZhcmlhYmxlcykge1xuICAgICAgICAgICAgb3V0cHV0W2tleV0gPSBhbGxDaGFpblZhbHVlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcInNlcXVlbnRpYWxfY2hhaW5cIjtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgICAgICAgY29uc3QgY2hhaW5zID0gW107XG4gICAgICAgIGNvbnN0IGlucHV0VmFyaWFibGVzID0gZGF0YS5pbnB1dF92YXJpYWJsZXM7XG4gICAgICAgIGNvbnN0IG91dHB1dFZhcmlhYmxlcyA9IGRhdGEub3V0cHV0X3ZhcmlhYmxlcztcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZENoYWlucyA9IGRhdGEuY2hhaW5zO1xuICAgICAgICBmb3IgKGNvbnN0IHNlcmlhbGl6ZWRDaGFpbiBvZiBzZXJpYWxpemVkQ2hhaW5zKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNlcmlhbGl6ZWRDaGFpbiA9IGF3YWl0IEJhc2VDaGFpbi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkQ2hhaW4pO1xuICAgICAgICAgICAgY2hhaW5zLnB1c2goZGVzZXJpYWxpemVkQ2hhaW4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU2VxdWVudGlhbENoYWluKHsgY2hhaW5zLCBpbnB1dFZhcmlhYmxlcywgb3V0cHV0VmFyaWFibGVzIH0pO1xuICAgIH1cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIGNvbnN0IGNoYWlucyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNoYWluIG9mIHRoaXMuY2hhaW5zKSB7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChjaGFpbi5zZXJpYWxpemUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIF90eXBlOiB0aGlzLl9jaGFpblR5cGUoKSxcbiAgICAgICAgICAgIGlucHV0X3ZhcmlhYmxlczogdGhpcy5pbnB1dFZhcmlhYmxlcyxcbiAgICAgICAgICAgIG91dHB1dF92YXJpYWJsZXM6IHRoaXMub3V0cHV0VmFyaWFibGVzLFxuICAgICAgICAgICAgY2hhaW5zLFxuICAgICAgICB9O1xuICAgIH1cbn1cbi8qKlxuICogQGRlcHJlY2F0ZWQgU3dpdGNoIHRvIGV4cHJlc3Npb24gbGFuZ3VhZ2U6IGh0dHBzOi8vanMubGFuZ2NoYWluLmNvbS9kb2NzL2V4cHJlc3Npb25fbGFuZ3VhZ2UvXG4gKiBTaW1wbGUgY2hhaW4gd2hlcmUgYSBzaW5nbGUgc3RyaW5nIG91dHB1dCBvZiBvbmUgY2hhaW4gaXMgZmVkIGRpcmVjdGx5IGludG8gdGhlIG5leHQuXG4gKiBAYXVnbWVudHMgQmFzZUNoYWluXG4gKiBAYXVnbWVudHMgU2ltcGxlU2VxdWVudGlhbENoYWluSW5wdXRcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGltcG9ydCB7IFNpbXBsZVNlcXVlbnRpYWxDaGFpbiwgTExNQ2hhaW4gfSBmcm9tIFwibGFuZ2NoYWluL2NoYWluc1wiO1xuICogaW1wb3J0IHsgT3BlbkFJIH0gZnJvbSBcImxhbmdjaGFpbi9sbG1zL29wZW5haVwiO1xuICogaW1wb3J0IHsgUHJvbXB0VGVtcGxhdGUgfSBmcm9tIFwibGFuZ2NoYWluL3Byb21wdHNcIjtcbiAqXG4gKiAvLyBUaGlzIGlzIGFuIExMTUNoYWluIHRvIHdyaXRlIGEgc3lub3BzaXMgZ2l2ZW4gYSB0aXRsZSBvZiBhIHBsYXkuXG4gKiBjb25zdCBsbG0gPSBuZXcgT3BlbkFJKHsgdGVtcGVyYXR1cmU6IDAgfSk7XG4gKiBjb25zdCB0ZW1wbGF0ZSA9IGBZb3UgYXJlIGEgcGxheXdyaWdodC4gR2l2ZW4gdGhlIHRpdGxlIG9mIHBsYXksIGl0IGlzIHlvdXIgam9iIHRvIHdyaXRlIGEgc3lub3BzaXMgZm9yIHRoYXQgdGl0bGUuXG4gKlxuICogVGl0bGU6IHt0aXRsZX1cbiAqIFBsYXl3cmlnaHQ6IFRoaXMgaXMgYSBzeW5vcHNpcyBmb3IgdGhlIGFib3ZlIHBsYXk6YFxuICogY29uc3QgcHJvbXB0VGVtcGxhdGUgPSBuZXcgUHJvbXB0VGVtcGxhdGUoeyB0ZW1wbGF0ZSwgaW5wdXRWYXJpYWJsZXM6IFtcInRpdGxlXCJdIH0pO1xuICogY29uc3Qgc3lub3BzaXNDaGFpbiA9IG5ldyBMTE1DaGFpbih7IGxsbSwgcHJvbXB0OiBwcm9tcHRUZW1wbGF0ZSB9KTtcbiAqXG4gKlxuICogLy8gVGhpcyBpcyBhbiBMTE1DaGFpbiB0byB3cml0ZSBhIHJldmlldyBvZiBhIHBsYXkgZ2l2ZW4gYSBzeW5vcHNpcy5cbiAqIGNvbnN0IHJldmlld0xMTSA9IG5ldyBPcGVuQUkoeyB0ZW1wZXJhdHVyZTogMCB9KVxuICogY29uc3QgcmV2aWV3VGVtcGxhdGUgPSBgWW91IGFyZSBhIHBsYXkgY3JpdGljIGZyb20gdGhlIE5ldyBZb3JrIFRpbWVzLiBHaXZlbiB0aGUgc3lub3BzaXMgb2YgcGxheSwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSByZXZpZXcgZm9yIHRoYXQgcGxheS5cbiAqXG4gKiBQbGF5IFN5bm9wc2lzOlxuICoge3N5bm9wc2lzfVxuICogUmV2aWV3IGZyb20gYSBOZXcgWW9yayBUaW1lcyBwbGF5IGNyaXRpYyBvZiB0aGUgYWJvdmUgcGxheTpgXG4gKiBjb25zdCByZXZpZXdQcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7IHRlbXBsYXRlOiByZXZpZXdUZW1wbGF0ZSwgaW5wdXRWYXJpYWJsZXM6IFtcInN5bm9wc2lzXCJdIH0pO1xuICogY29uc3QgcmV2aWV3Q2hhaW4gPSBuZXcgTExNQ2hhaW4oeyBsbG06IHJldmlld0xMTSwgcHJvbXB0OiByZXZpZXdQcm9tcHRUZW1wbGF0ZSB9KTtcbiAqXG4gKiBjb25zdCBvdmVyYWxsQ2hhaW4gPSBuZXcgU2ltcGxlU2VxdWVudGlhbENoYWluKHtjaGFpbnM6IFtzeW5vcHNpc0NoYWluLCByZXZpZXdDaGFpbl0sIHZlcmJvc2U6dHJ1ZX0pXG4gKiBjb25zdCByZXZpZXcgPSBhd2FpdCBvdmVyYWxsQ2hhaW4ucnVuKFwiVHJhZ2VkeSBhdCBzdW5zZXQgb24gdGhlIGJlYWNoXCIpXG4gKiAvLyB0aGUgdmFyaWFibGUgcmV2aWV3IGNvbnRhaW5zIHJlc3VsdGluZyBwbGF5IHJldmlldy5cbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgU2ltcGxlU2VxdWVudGlhbENoYWluIGV4dGVuZHMgQmFzZUNoYWluIHtcbiAgICBzdGF0aWMgbGNfbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiU2ltcGxlU2VxdWVudGlhbENoYWluXCI7XG4gICAgfVxuICAgIGdldCBpbnB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5pbnB1dEtleV07XG4gICAgfVxuICAgIGdldCBvdXRwdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMub3V0cHV0S2V5XTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkcyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNoYWluc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJpbnB1dFwiXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvdXRwdXRLZXlcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFwib3V0cHV0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRyaW1PdXRwdXRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2hhaW5zID0gZmllbGRzLmNoYWlucztcbiAgICAgICAgdGhpcy50cmltT3V0cHV0cyA9IGZpZWxkcy50cmltT3V0cHV0cyA/PyBmYWxzZTtcbiAgICAgICAgdGhpcy5fdmFsaWRhdGVDaGFpbnMoKTtcbiAgICB9XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICBfdmFsaWRhdGVDaGFpbnMoKSB7XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGlmIChjaGFpbi5pbnB1dEtleXMuZmlsdGVyKChrKSA9PiAhY2hhaW4ubWVtb3J5Py5tZW1vcnlLZXlzLmluY2x1ZGVzKGspID8/IHRydWUpLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2hhaW5zIHVzZWQgaW4gU2ltcGxlU2VxdWVudGlhbENoYWluIHNob3VsZCBhbGwgaGF2ZSBvbmUgaW5wdXQsIGdvdCAke2NoYWluLmlucHV0S2V5cy5sZW5ndGh9IGZvciAke2NoYWluLl9jaGFpblR5cGUoKX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hhaW4ub3V0cHV0S2V5cy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENoYWlucyB1c2VkIGluIFNpbXBsZVNlcXVlbnRpYWxDaGFpbiBzaG91bGQgYWxsIGhhdmUgb25lIG91dHB1dCwgZ290ICR7Y2hhaW4ub3V0cHV0S2V5cy5sZW5ndGh9IGZvciAke2NoYWluLl9jaGFpblR5cGUoKX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEBpZ25vcmUgKi9cbiAgICBhc3luYyBfY2FsbCh2YWx1ZXMsIHJ1bk1hbmFnZXIpIHtcbiAgICAgICAgbGV0IGlucHV0ID0gdmFsdWVzW3RoaXMuaW5wdXRLZXldO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGkgKz0gMTtcbiAgICAgICAgICAgIGlucHV0ID0gKGF3YWl0IGNoYWluLmNhbGwoeyBbY2hhaW4uaW5wdXRLZXlzWzBdXTogaW5wdXQsIHNpZ25hbDogdmFsdWVzLnNpZ25hbCB9LCBydW5NYW5hZ2VyPy5nZXRDaGlsZChgc3RlcF8ke2l9YCkpKVtjaGFpbi5vdXRwdXRLZXlzWzBdXTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyaW1PdXRwdXRzKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQgPSBpbnB1dC50cmltKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBydW5NYW5hZ2VyPy5oYW5kbGVUZXh0KGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBbdGhpcy5vdXRwdXRLZXldOiBpbnB1dCB9O1xuICAgIH1cbiAgICBfY2hhaW5UeXBlKCkge1xuICAgICAgICByZXR1cm4gXCJzaW1wbGVfc2VxdWVudGlhbF9jaGFpblwiO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgZGVzZXJpYWxpemUoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbnMgPSBbXTtcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZENoYWlucyA9IGRhdGEuY2hhaW5zO1xuICAgICAgICBmb3IgKGNvbnN0IHNlcmlhbGl6ZWRDaGFpbiBvZiBzZXJpYWxpemVkQ2hhaW5zKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNlcmlhbGl6ZWRDaGFpbiA9IGF3YWl0IEJhc2VDaGFpbi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkQ2hhaW4pO1xuICAgICAgICAgICAgY2hhaW5zLnB1c2goZGVzZXJpYWxpemVkQ2hhaW4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlU2VxdWVudGlhbENoYWluKHsgY2hhaW5zIH0pO1xuICAgIH1cbiAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgIGNvbnN0IGNoYWlucyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNoYWluIG9mIHRoaXMuY2hhaW5zKSB7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChjaGFpbi5zZXJpYWxpemUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIF90eXBlOiB0aGlzLl9jaGFpblR5cGUoKSxcbiAgICAgICAgICAgIGNoYWlucyxcbiAgICAgICAgfTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/langchain/dist/chains/sequential_chain.js\n"));

/***/ }),

/***/ "./node_modules/langchain/dist/util/set.js":
/*!*************************************************!*\
  !*** ./node_modules/langchain/dist/util/set.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   difference: function() { return /* binding */ difference; },\n/* harmony export */   intersection: function() { return /* binding */ intersection; },\n/* harmony export */   union: function() { return /* binding */ union; }\n/* harmony export */ });\n/**\n * Source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#implementing_basic_set_operations\n */\n/**\n * returns intersection of two sets\n */\nfunction intersection(setA, setB) {\n    const _intersection = new Set();\n    for (const elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\n/**\n * returns union of two sets\n */\nfunction union(setA, setB) {\n    const _union = new Set(setA);\n    for (const elem of setB) {\n        _union.add(elem);\n    }\n    return _union;\n}\n/**\n * returns difference of two sets\n */\nfunction difference(setA, setB) {\n    const _difference = new Set(setA);\n    for (const elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvdXRpbC9zZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvdXRpbC9zZXQuanM/NDFkYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNvdXJjZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvU2V0I2ltcGxlbWVudGluZ19iYXNpY19zZXRfb3BlcmF0aW9uc1xuICovXG4vKipcbiAqIHJldHVybnMgaW50ZXJzZWN0aW9uIG9mIHR3byBzZXRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oc2V0QSwgc2V0Qikge1xuICAgIGNvbnN0IF9pbnRlcnNlY3Rpb24gPSBuZXcgU2V0KCk7XG4gICAgZm9yIChjb25zdCBlbGVtIG9mIHNldEIpIHtcbiAgICAgICAgaWYgKHNldEEuaGFzKGVsZW0pKSB7XG4gICAgICAgICAgICBfaW50ZXJzZWN0aW9uLmFkZChlbGVtKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gX2ludGVyc2VjdGlvbjtcbn1cbi8qKlxuICogcmV0dXJucyB1bmlvbiBvZiB0d28gc2V0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gdW5pb24oc2V0QSwgc2V0Qikge1xuICAgIGNvbnN0IF91bmlvbiA9IG5ldyBTZXQoc2V0QSk7XG4gICAgZm9yIChjb25zdCBlbGVtIG9mIHNldEIpIHtcbiAgICAgICAgX3VuaW9uLmFkZChlbGVtKTtcbiAgICB9XG4gICAgcmV0dXJuIF91bmlvbjtcbn1cbi8qKlxuICogcmV0dXJucyBkaWZmZXJlbmNlIG9mIHR3byBzZXRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKHNldEEsIHNldEIpIHtcbiAgICBjb25zdCBfZGlmZmVyZW5jZSA9IG5ldyBTZXQoc2V0QSk7XG4gICAgZm9yIChjb25zdCBlbGVtIG9mIHNldEIpIHtcbiAgICAgICAgX2RpZmZlcmVuY2UuZGVsZXRlKGVsZW0pO1xuICAgIH1cbiAgICByZXR1cm4gX2RpZmZlcmVuY2U7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/langchain/dist/util/set.js\n"));

/***/ })

}]);